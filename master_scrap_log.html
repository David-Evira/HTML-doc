# PSEUDOCODE: DASHBOARD_UI (ScrapLog.html)

INITIALIZE:
    LOAD external PDF generation libraries
    IF localStorage has backup: LOAD data
    IF scrap_data.js exists: LOAD data (Prioritize over local storage)
    
    START Heartbeat Monitor (Every 2 seconds)
    START Mutation Observer (Prevent users from deleting the lockout screen)

UI MECHANICS:

    # --- 1. THE HEARTBEAT & LOCKOUT ---
    FUNCTION checkHeartbeat():
        TRY to load 'heartbeat.js' with a random timestamp (prevent caching)
        IF SUCCESS:
            HIDE Lockout Screen
            EXTRACT 'currentUser' variable from heartbeat.js
            RUN checkPermissions(currentUser)
        IF FAIL:
            SHOW "SYSTEM OFFLINE" Overlay
            DISABLE all inputs

    # --- 2. PERMISSION SYSTEM ---
    FUNCTION checkPermissions(user):
        IF user is in WHITELIST:
            ENABLE Save, Email, PDF, and Reset buttons
        ELSE:
            DISABLE Action Buttons
            SHOW "Access Denied" tooltip on hover

    # --- 3. DATA MANAGEMENT ---
    ON "Save" Click:
        COMPILE Header info (Dept, Shift, Line) + Table Rows
        CREATE a Text Blob formatted as Javascript
        TRIGGER Download for "SCRAP_EXPORT_DATA.txt"
        (This file is then intercepted by the Sync Batch script)

    ON "Email" Click:
        IF rows are selected: Process selected only
        ELSE: Process all valid entries
        FORMAT data into a plain-text report
        COPY report to Clipboard
        OPEN default Email client with report in body

    # --- 4. TABLE LOGIC ---
    ON "Add Row":
        APPEND empty entry to Master Data Array
        RE-RENDER Table (Page 1)
        
    ON "Filter" Input:
        SEARCH Tag #, Bin #, or Date columns for matching text
        UPDATE visible indices and RE-RENDER Table

    # --- 5. SMART FEATURES ---
    - Automatic Timestamp: Clicking a date cell fills the current time.
    - Weight Warning: If "Act Lbs" > 30,000, highlight red with a warning icon.
    - Anti-Tamper: If systemActive is toggled to false, force-refresh the page.
